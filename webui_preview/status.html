<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VL53L1x Status</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body { padding: 20px; background-color: #f5f5f5; }
.container { max-width: 900px; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
h1 { color: #333; margin-bottom: 30px; }
.status-card { border: 1px solid #ddd; border-radius: 8px; padding: 20px; margin-bottom: 20px; }
.status-value { font-size: 24px; font-weight: bold; color: #007bff; }
</style>
</head>
<body>
<div class="container">
<h1>VL53L1x Sensor Status</h1>
<div class="status-card">
<h3>Current Readings</h3>
<div class="row">
<div class="col-md-6">
<p><strong>Distance:</strong> <span class="status-value" id="distance">-</span> mm</p>
<p><strong>Status:</strong> <span id="status">-</span></p>
<p><strong>Ambient:</strong> <span id="ambient">-</span> kcps</p>
</div>
<div class="col-md-6">
<p><strong>Signal per SPAD:</strong> <span id="sig_per_spad">-</span> kcps/SPAD</p>
<p><strong>Number of SPADs:</strong> <span id="num_spads">-</span></p>
</div>
</div>
</div>
<div class="status-card">
<h3>Configuration</h3>
<div class="row">
<div class="col-md-6">
<p><strong>Distance Mode:</strong> <span id="config_distance_mode">-</span></p>
<p><strong>Timing Budget:</strong> <span id="config_timing_budget">-</span> ms</p>
<p><strong>Inter-Measurement:</strong> <span id="config_inter_measurement">-</span> ms</p>
</div>
</div>
</div>
<div class="btn-group">
<a href="index.html" class="btn btn-primary">Configuration</a>
<button class="btn btn-secondary" onclick="location.reload()">Refresh</button>
<a href="ota.html" class="btn btn-success">OTA Update</a>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
// Mock data for preview
let mockDistance = 1234;
let mockAmbient = 45;
let mockSigPerSPAD = 12;
let mockNumSPADs = 64;

function updateStatus() {
  // Simulate API call with mock data
  setTimeout(() => {
    // Simulate sensor reading changes
    mockDistance += Math.floor(Math.random() * 20) - 10;
    if (mockDistance < 0) mockDistance = 0;
    if (mockDistance > 4000) mockDistance = 4000;
    
    mockAmbient += Math.floor(Math.random() * 5) - 2;
    if (mockAmbient < 0) mockAmbient = 0;
    
    mockSigPerSPAD += Math.floor(Math.random() * 3) - 1;
    if (mockSigPerSPAD < 0) mockSigPerSPAD = 0;
    
    const mockData = {
      distance_mm: mockDistance,
      status: 0,
      ambient_kcps: mockAmbient,
      sig_per_spad_kcps: mockSigPerSPAD,
      num_spads: mockNumSPADs,
      config: {
        distance_mode: 2,
        timing_budget_ms: 100,
        inter_measurement_ms: 100
      }
    };
    
    document.getElementById('distance').textContent = mockData.distance_mm;
    document.getElementById('status').textContent = mockData.status === 0 ? 'Valid' : 'Error ' + mockData.status;
    document.getElementById('ambient').textContent = mockData.ambient_kcps;
    document.getElementById('sig_per_spad').textContent = mockData.sig_per_spad_kcps;
    document.getElementById('num_spads').textContent = mockData.num_spads;
    const mode = mockData.config.distance_mode === 1 ? 'SHORT' : 'LONG';
    document.getElementById('config_distance_mode').textContent = mode;
    document.getElementById('config_timing_budget').textContent = mockData.config.timing_budget_ms;
    document.getElementById('config_inter_measurement').textContent = mockData.config.inter_measurement_ms;
  }, 100);
}

updateStatus();
setInterval(updateStatus, 1000);
</script>
</body>
</html>

