<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Firmware Update</title><style>* { box-sizing: border-box; }body { padding: 0; margin: 0; background-color: #f5f5f5; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; }.navbar { background-color: #212529; padding: 15px 0; margin-bottom: 20px; }.navbar-nav { display: flex; flex-direction: row; list-style: none; margin: 0; padding: 0 20px; justify-content: flex-start; align-items: center; width: 100%; }.navbar-nav li { margin: 0 15px; }.navbar-nav a { color: #ffffff; text-decoration: none; font-weight: 500; padding: 8px 16px; border-radius: 4px; transition: background-color 0.2s; }.navbar-nav a:hover { background-color: rgba(255, 255, 255, 0.1); }.navbar-nav a.active { background-color: #007bff; }.navbar-nav li.sensor-nav-item { display: none; }.content-wrapper { padding: 20px; }.container { max-width: 800px; background: white; padding: 0; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin: 0 auto; overflow: hidden; }.page-header { background-color: #f8f9fa; padding: 20px 30px; border-bottom: 1px solid #dee2e6; }.page-header h1 { margin: 0; color: #212529; font-size: 1.75rem; font-weight: 700; text-transform: uppercase; }.page-content { padding: 30px; }.form-group { margin-bottom: 20px; }label { font-weight: 600; color: #555; display: block; margin-bottom: 5px; }.form-control { display: block; width: 100%; padding: 8px 12px; font-size: 14px; line-height: 1.5; color: #495057; background-color: #fff; border: 1px solid #ced4da; border-radius: 4px; }.form-control:focus { border-color: #80bdff; outline: 0; box-shadow: 0 0 0 0.2rem rgba(0,123,255,0.25); }input[type="file"] { display: block; width: 100%; padding: 8px 12px; font-size: 14px; line-height: 1.5; color: #495057; background-color: #fff; border: 1px solid #ced4da; border-radius: 4px; cursor: pointer; }input[type="file"]::-webkit-file-upload-button { padding: 6px 12px; margin-right: 12px; color: #fff; background-color: #007bff; border: 1px solid #007bff; border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: 400; }input[type="file"]::-webkit-file-upload-button:hover { background-color: #0069d9; border-color: #0062cc; }input[type="file"]::file-selector-button { padding: 6px 12px; margin-right: 12px; color: #fff; background-color: #007bff; border: 1px solid #007bff; border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: 400; }input[type="file"]::file-selector-button:hover { background-color: #0069d9; border-color: #0062cc; }.btn { display: inline-block; padding: 8px 16px; font-size: 14px; font-weight: 400; text-align: center; cursor: pointer; border: 1px solid transparent; border-radius: 4px; text-decoration: none; }.btn-primary { color: #fff; background-color: #007bff; border-color: #007bff; }.btn-primary:hover { background-color: #0069d9; border-color: #0062cc; }.alert { position: relative; padding: 12px 20px; margin-bottom: 20px; border: 1px solid transparent; border-radius: 4px; }.alert-success { color: #155724; background-color: #d4edda; border-color: #c3e6cb; }.alert-danger { color: #721c24; background-color: #f8d7da; border-color: #f5c6cb; }.alert-warning { color: #856404; background-color: #fff3cd; border-color: #ffeaa7; }.alert-info { color: #0c5460; background-color: #d1ecf1; border-color: #bee5eb; }</style></head><body><nav class="navbar"><ul class="navbar-nav"><li><a href="index.html">Configuration</a></li><li class="sensor-nav-item"><a href="status.html">VL53L1x</a></li><li><a href="inputassembly.html">T->O</a></li><li><a href="outputassembly.html">O->T</a></li><li><a href="ota.html" class="active">Firmware Update</a></li></ul></nav><div class="content-wrapper"><div class="container"><div class="page-header"><h1>Firmware Update</h1></div><div class="page-content"><div style="margin-bottom: 20px; padding: 12px; background-color: #f8f9fa; border-left: 4px solid #007bff; border-radius: 4px;"><p style="margin: 0; color: #495057; font-size: 14px; line-height: 1.6;"><strong>Over-The-Air (OTA) Firmware Update:</strong> Upload a new firmware binary file (.bin) to update the device firmware wirelessly. Select the firmware file and click "Start Update" to begin the process. The device will automatically reboot after a successful update. Ensure the firmware file is compatible with your device model and that you maintain a stable network connection during the update process.</p></div><div class="form-group"><label>Upload Firmware File (.bin)</label><input type="file" class="form-control" id="firmware_file" accept=".bin"></div><div id="message" class="alert" style="display:none; margin-top:20px;"></div><button type="button" class="btn btn-primary" onclick="startOTA()" style="margin-top:20px;">Start Update</button></div><footer style="text-align: center; padding: 20px 30px; border-top: 1px solid #dee2e6; color: #666; background-color: #f8f9fa;">OpENer Ethernet/IP for ESP32-P4 | Adam G Sweeney 11-15-2025</footer></div></div><script>function showMessage(text, type) {  const msg = document.getElementById('message');  msg.textContent = text;  msg.className = 'alert alert-' + type;  msg.style.display = 'block';}function startOTA() {  const fileInput = document.getElementById('firmware_file');  if (!fileInput) {    showMessage('Error: File input not found', 'danger');    return;  }  const file = fileInput.files[0];  if (!file) {    showMessage('Please select a firmware file', 'warning');    return;  }  const formData = new FormData();  formData.append('firmware', file);  showMessage('Uploading firmware...', 'info');  fetch('/api/ota/update', {    method: 'POST',    body: formData  })    .then(function(r) {      if (!r.ok) {        throw new Error('HTTP ' + r.status);      }      return r.json();    })    .then(function(data) {      if (data.status === 'ok') {        showMessage('Firmware uploaded successfully. Device will reboot in a few seconds...', 'success');        setTimeout(function() {          window.location.href = '/';        }, 5000);      } else {        showMessage('Firmware update failed: ' + (data.message || 'Unknown error'), 'danger');      }    })    .catch(function(err) {      showMessage('Error: ' + err.message, 'danger');    });}function updateNavigationBar() {  fetch('/api/sensor/enabled')    .then(r => {      if (!r.ok) throw new Error('HTTP ' + r.status);      return r.json();    })    .then(data => {      const navItems = document.querySelectorAll('nav li.sensor-nav-item');      navItems.forEach(item => {        if (item) {          item.style.display = data.enabled ? 'block' : 'none';        }      });    })    .catch(err => {      console.error('Failed to update navigation bar:', err);    });}updateNavigationBar();</script></body></html>